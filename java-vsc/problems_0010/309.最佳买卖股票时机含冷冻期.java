/*
 * @lc app=leetcode.cn id=309 lang=java
 *
 * [309] æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ
 *
 * https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/description/
 *
 * algorithms
 * Medium (53.48%)
 * Likes:    345
 * Dislikes: 0
 * Total Accepted:    28.7K
 * Total Submissions: 53.3K
 * Testcase Example:  '[1,2,3,0,2]'
 *
 * ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå…¶ä¸­ç¬¬Â iÂ ä¸ªå…ƒç´ ä»£è¡¨äº†ç¬¬Â iÂ å¤©çš„è‚¡ç¥¨ä»·æ ¼ ã€‚â€‹
 * 
 * è®¾è®¡ä¸€ä¸ªç®—æ³•è®¡ç®—å‡ºæœ€å¤§åˆ©æ¶¦ã€‚åœ¨æ»¡è¶³ä»¥ä¸‹çº¦æŸæ¡ä»¶ä¸‹ï¼Œä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰:
 * 
 * 
 * ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚
 * å–å‡ºè‚¡ç¥¨åï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒå¤©ä¹°å…¥è‚¡ç¥¨ (å³å†·å†»æœŸä¸º 1 å¤©)ã€‚
 * 
 * 
 * ç¤ºä¾‹:
 * 
 * è¾“å…¥: [1,2,3,0,2]
 * è¾“å‡º: 3 
 * è§£é‡Š: å¯¹åº”çš„äº¤æ˜“çŠ¶æ€ä¸º: [ä¹°å…¥, å–å‡º, å†·å†»æœŸ, ä¹°å…¥, å–å‡º]
 * 
 */

// @lc code=start
class Solution {
    public int maxProfit(int[] prices) {
        int n = prices.length;
        if (n < 2) {
            return 0;
        }
        if (n < 3) {
            if (prices[1] > prices[0]) {
                return prices[1] - prices[0];
            } else {
                return 0;
            }
        }
        int [][]dp = new int[n][2];
        // dp[i][0]ï¼Œç¬¬iå¤©ä¸æŒæœ‰æœ€å¤§åˆ©æ¶¦ï¼›
        // dp[i][1], ç¬¬iå¤©æŒæœ‰æœ€å¤§åˆ©æ¶¦
        dp[0][0] = 0;
        dp[0][1] = -prices[0];
        dp[1][0] = Math.max(dp[0][0], dp[0][1] + prices[1]);
        dp[1][1] = Math.max(dp[0][1], -prices[1]);
        for (int i = 2; i < n; i++) {
            dp[i][0] = Math.max(dp[i-1][0], dp[i-1][1] + prices[i]);
            dp[i][1] = Math.max(dp[i-1][1], dp[i-2][0] - prices[i]);
        }
        return dp[n-1][0];
    }
}
// @lc code=end


// ä»£ç æ”¶è—
// class Solution {
//     public int maxProfit(int[] prices) {
//         int len = prices.length;
//         if (len < 2) return 0;

//         //0è¡¨ç¤ºæœ¬ä¸æŒæœ‰ï¼Œ1è¡¨ç¤ºæŒæœ‰ï¼Œ2è¡¨ç¤ºå½“å¤©å–å‡ºï¼Œä¸æŒæœ‰
//         int[][] dp = new int[len][3];  //ç”¨äºŒç»´æ•°ç»„è®°å½•å½“å¤©å„ç§æƒ…å†µçš„æœ€ä¼˜è§£(æ”¶ç›Šçš„æœ€å¤§å€¼)
//         dp[0][1] = -prices[0];  //ç¬¬ä¸€å¤©è‹¥æŒæœ‰ï¼Œåˆ™æ”¶ç›Šä¸ºè´Ÿï¼›ä¸æŒæœ‰åˆ™æ”¶ç›Šä¸ºé›¶

//         for (int i = 1; i < len; i++){
//             dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][2]);  //å½“å¤©çš„æœ¬ä¸æŒæœ‰å¯ä»¥ç”±å‰ä¸€å¤©æœ¬ä¸æŒæœ‰æˆ–å‰ä¸€å¤©å–å‡ºå¾—åˆ°
//             dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] - prices[i]);  //å½“å¤©çš„æŒæœ‰å¯ä»¥ç”±å‰ä¸€å¤©çš„æŒæœ‰æˆ–å‰ä¸€å¤©çš„æœ¬ä¸æŒæœ‰-å½“å¤©çš„è‚¡ç¥¨ä»·æ ¼å¾—åˆ°, å³ä¹°è¿›ä¸€åªè‚¡ç¥¨
//             dp[i][2] = dp[i - 1][1] + prices[i];  //å½“å¤©å–å‡ºå¯ä»¥ç”±å‰ä¸€å¤©çš„æŒæœ‰+å½“å¤©çš„è‚¡ç¥¨ä»·æ ¼å¾—åˆ°, å³å–å‡ºæ‰‹ä¸­çš„è‚¡ç¥¨
//         }
//         return Math.max(dp[len - 1][0], dp[len - 1][2]);  //è¿”å›æœ€åä¸€å¤©ä¸æŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€ï¼Œæ­¤å¤„å¯ä»¥å¾—åˆ°æ”¶ç›Šçš„æœ€å¤§å€¼
//     }
// }



// ä»£ç æ”¶è—ï¼Œä¼˜åŒ–ç©ºé—´å¤æ‚åº¦
// class Solution {
//     public int maxProfit(int[] prices) {
//         int len = prices.length;
//         if (len < 2) return 0;

//         //xè¡¨ç¤ºæœ¬ä¸æŒæœ‰ï¼Œyè¡¨ç¤ºæŒæœ‰ï¼Œzè¡¨ç¤ºå½“å¤©å–å‡ºï¼Œä¸æŒæœ‰
//         int x = 0, y = -prices[0], z = 0;
// //        int[][] dp = new int[len][3];
// //        dp[0][1] = -prices[0];

//         for (int i = 1; i < len; i++){
//             int temp = y;
//             y = Math.max(y, x - prices[i]);
//             //dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] - prices[i]);

//             x = Math.max(x, z);
//             //dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][2]);

//             z = y + prices[i];
//             //dp[i][2] = dp[i - 1][1] + prices[i];
//         }
//         return Math.max(x, z);
//     }
// }



// ä»£ç æ”¶è—

// class Solution {
//     public int maxProfit(int[] prices) {
//         int n = prices.length;
//         if (n <= 1)
//             return 0;

//         int[][] dp = new int[n][3];
//         dp[0][0] = 0;
//         dp[0][1] = -1 * prices[0];
//         dp[0][2] = 0;

//         for (int i = 1; i < n; i++) {// ä»[1]...[n-1]
//             dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][2]);
//             dp[i][1] = Math.max(dp[i - 1][1], dp[i - 1][0] - prices[i]);
//             dp[i][2] = dp[i - 1][1] + prices[i];

//         }

//         return Math.max(dp[n - 1][0], dp[n - 1][2]);
//     }
// }





è§£æ³•ä¸€ã€‚å…ˆæ”¾C++ä»£ç ï¼ŒäºŒç»´åŠ¨æ€è§„åˆ’è§£æ³•ã€‚
/*
dp[len][2]

case 1: We have a stock on day i, dp[i][1] (calculate the max of the below)
- I bought it today
    dp[i-2][0] - prices[i] 
- I am carry forwarding
    dp[i-1][1]

case 2: We have no stock on day i, dp[i][0] (calculate the max of the below)
- I sold it today
    dp[i-1][1] + prices[i]
- I am carry forwarding, doing nothing
    dp[i-1][0]
*/

class Solution {
public:
    int maxProfit(vector<int>& prices) {
        int len = prices.size();
        if(len <= 1) return 0; // ç‰¹æ®Šæƒ…å†µå¤„ç†

        if(len==2 && prices[0]>=prices[1]) return 0; // ç‰¹æ®Šæƒ…å†µå¤„ç†
        else if(len == 2 && prices[0]<prices[1]) return prices[1]-prices[0]; // ç‰¹æ®Šæƒ…å†µå¤„ç†

        int dp[len][2]; // äºŒç»´åŠ¨æ€è§„åˆ’å¼€å§‹

        dp[0][0] = 0; // ç¬¬ä¸€å¤©ï¼Œä¸æŒæœ‰è‚¡ç¥¨
        dp[0][1] = -prices[0]; // ç¬¬ä¸€å¤©ï¼ŒæŒæœ‰è‚¡ç¥¨
        dp[1][0] = max(dp[0][0], dp[0][1] + prices[1]); // ç¬¬äºŒå¤©ï¼Œä¸æŒæœ‰è‚¡ç¥¨
        dp[1][1] = max(dp[0][0]-prices[1], dp[0][1]); // ç¬¬äºŒå¤©ï¼ŒæŒæœ‰è‚¡ç¥¨

        for(int i=2;i<len;++i)
        {
            dp[i][0] = max(dp[i-1][1] + prices[i], dp[i-1][0]); // ç¬¬iå¤©ï¼Œä¸æŒæœ‰è‚¡ç¥¨
            dp[i][1] = max(dp[i-2][0] - prices[i], dp[i-1][1]); // ç¬¬iå¤©ï¼ŒæŒæœ‰è‚¡ç¥¨
        }

        return dp[len-1][0];
    }
};

æ‰§è¡Œç»“æœæˆªå›¾

è§£é¢˜æ€è·¯


é¦–å…ˆæ˜ç¡®ä¸€ä¸ªä¸­å¿ƒæ€è·¯ï¼Œç¬¬iå¤©çš„æƒ…å†µåªæœ‰å¯èƒ½æ˜¯ä¸¤ç§ï¼šæŒæœ‰è‚¡ç¥¨ï¼Œæˆ–è€…ä¸æŒæœ‰è‚¡ç¥¨ã€‚


æˆ‘ä»¬ç”¨äºŒç»´åŠ¨æ€è§„åˆ’æ¥å¾—åˆ°æ¯ä¸€å¤©çš„æœ€å¤§åˆ©æ¶¦å’Œã€‚é¦–å…ˆå®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„dp[len][2]ï¼Œåˆ—æ•°æ˜¯pricesçš„å¤§å°ï¼ˆä¹Ÿå°±æ˜¯ä¸€å…±æœ‰å¤šå°‘å¤©ï¼‰ï¼Œè¡Œæ•°æ˜¯2ï¼ˆç¬¬ä¸€è¡Œè¡¨ç¤ºä¸æŒæœ‰è‚¡ç¥¨ï¼Œç¬¬äºŒè¡Œè¡¨ç¤ºæŒæœ‰è‚¡ç¥¨ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯”dp[0][0]åˆ™æ˜¯è¡¨ç¤ºç¬¬1å¤©ä¸æŒæœ‰è‚¡ç¥¨çš„æƒ…å†µï¼›dp[2][1]åˆ™æ˜¯è¡¨ç¤ºç¬¬3å¤©æŒæœ‰è‚¡ç¥¨çš„æƒ…å†µã€‚


å¦‚æœæ˜¯æŒæœ‰è‚¡ç¥¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºæ˜¯åœ¨å½“å¤©ä¹°äº†è¿™æ”¯è‚¡ç¥¨ï¼Œå’Œä¹‹å‰æŸå¤©å°±ä¹°äº†ï¼Œç¬¬iå¤©ç»§ç»­æŒæœ‰ã€‚



å¦‚æœç¬¬iå¤©æ˜¯æŒæœ‰è‚¡ç¥¨+åœ¨å½“å¤©ä¹°äº†è¿™åªè‚¡ç¥¨çš„çŠ¶æ€ï¼Œé‚£ä¹ˆç¬¬i-1å¤©ä¸€å®šæ˜¯å†·å†»æœŸï¼ˆcooldownï¼‰ï¼Œå› ä¸ºå¿…é¡»è¦å…ˆå–æ‰èƒ½ä¹°ï¼Œè€Œå–äº†ä¹‹åå°±ä¼šæœ‰ä¸€å¤©å†·å†»æœŸã€‚å› æ­¤åœ¨ç¬¬iå¤©çš„æœ€å¤§åˆ©æ¶¦å’Œå°±æ˜¯ç¬¬i-2å¤©çš„æœ€å¤§åˆ©æ¶¦å’Œ - ç¬¬iå¤©çš„ä»·æ ¼ï¼ˆå¯ä»¥ç†è§£ä¸ºæ”¶å…¥-æˆæœ¬=åˆ©æ¶¦ï¼‰ï¼Œå³dp[i-2][0] - prices[i]ã€‚ï¼ˆä¹‹æ‰€ä»¥æ˜¯dp[i-2][0]ï¼Œæ˜¯å› ä¸ºåœ¨ç¬¬i-2å¤©å–å‡ºå»äº†ï¼Œå³ä¸æŒæœ‰è‚¡ç¥¨ï¼Œæ‰€ä»¥æ˜¯[0]ï¼‰
å¦‚æœç¬¬iå¤©æ˜¯æŒæœ‰è‚¡ç¥¨+ä¹‹å‰æŸå¤©å°±ä¹°äº†ï¼Œç¬¬iå¤©ç»§ç»­æŒæœ‰çš„çŠ¶æ€ï¼Œé‚£ä¹ˆç¬¬iå¤©æ²¡æœ‰åšä»»ä½•æ“ä½œï¼Œä¸ç¬¬i-1å¤©æ˜¯ä¸€æ ·çš„ï¼Œå³dp[i-1][1]ã€‚
æ‰€ä»¥æŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€ä¸‹ï¼Œæœ€å¤§åˆ©æ¶¦å’Œå°±æ˜¯dp[i][1] = max(dp[i-2][0] - prices[i], dp[i-1][1])ã€‚


å¦‚æœæ˜¯ä¸æŒæœ‰è‚¡ç¥¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºæ˜¯åœ¨å½“å¤©å–äº†è¿™æ”¯è‚¡ç¥¨ï¼Œå’Œä¹‹å‰å°±å–äº†ï¼Œç¬¬iå¤©ä¹Ÿæ²¡æœ‰ä¹°å…¥ã€‚


å¦‚æœç¬¬iå¤©æ˜¯ä¸æŒæœ‰è‚¡ç¥¨+åœ¨å½“å¤©å–äº†è¿™æ”¯è‚¡ç¥¨çš„çŠ¶æ€ï¼Œé‚£ä¹ˆæ˜¨å¤©å¿…ç„¶æ˜¯æŒæœ‰è‚¡ç¥¨çš„ï¼Œæœ€å¤§æ”¶ç›Šå°±æ˜¯ä»Šå¤©çš„ä»·æ ¼ - ç¬¬i-1å¤©ä¹°è‚¡ç¥¨èŠ±çš„é’±ï¼Œå³dp[i-1][1] + prices[i]ã€‚
å¦‚æœç¬¬iå¤©æ˜¯ä¸æŒæœ‰è‚¡ç¥¨+ä¹‹å‰å°±å–äº†ï¼Œç¬¬iå¤©ä¹Ÿæ²¡æœ‰ä¹°å…¥çš„çŠ¶æ€ï¼Œé‚£ä¹ˆä¹‹å‰ä¸€å¤©ä¹Ÿå·²ç»æ˜¯ä¸æŒæœ‰è‚¡ç¥¨çš„ï¼Œé‚£ä¹ˆæœ€å¤§æ”¶ç›Šå°±æ˜¯dp[i-1][0]ã€‚
æ‰€ä»¥ä¸æŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€ä¸‹ï¼Œæœ€å¤§åˆ©æ¶¦å’Œå°±æ˜¯dp[i][0] = max(dp[i-1][1] + prices[i], dp[i-1][0])ã€‚



æ³¨æ„ï¼Œç”±äºä»£ç ä¸­å‡ºç°äº†i-2ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„iæœ€å°ä¹Ÿè¦ä»2å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»å…ˆæ‰‹åŠ¨è€ƒè™‘dp[0][0], dp[0][1], dp[1][0], dp[1][1]å››ç§æƒ…å†µï¼ˆåœ¨ä»£ç ä¸­å·²å†™å¥½ï¼Œä¸åšå¤šä½™è§£é‡Šäº†ï¼‰ã€‚


æ€è·¯å¦‚æœ‰å†™å¾—æœ‰é—®é¢˜çš„åœ°æ–¹ï¼Œè¿˜è¦éº»çƒ¦å¤§å®¶è¯„è®ºåŒºä¸­æŒ‡å‡ºğŸ¦†ã€‚


Reference
https://www.youtube.com/watch?v=w6xk5Po-DX0
è§£æ³•äºŒï¼ˆæ›´ä¼˜åŒ–ï¼‰ã€‚å…ˆæ”¾C++ä»£ç ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œä½†æ˜¯ç©ºé—´å¤æ‚åº¦é™ä¸ºäº†O(1)ï¼Œå› ä¸ºæ¯ä¸€æ¬¡çš„è¿ç®—åªè·Ÿå‰ä¸€å¤©æœ‰å…³ç³»ã€‚
class Solution {
public:
    int maxProfit(vector<int>& prices) {
        int len = prices.size();

        if(len <= 1) return 0;

        vector<int> hold(len, 0);
        vector<int> rest(len, 0);
        vector<int> sold(len, 0);

        hold[0] = -prices[0];
        rest[0] = 0;
        sold[0] = INT_MIN;

        for(int i=1;i<len;++i)
        {
            hold[i] = max(hold[i-1], rest[i-1]-prices[i]);
            rest[i] = max(rest[i-1], sold[i-1]);
            sold[i] = hold[i-1] + prices[i];
        }

        return max(rest[len-1], sold[len-1]);
    }
};

ä½œè€…ï¼šsuperkakayong
é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/solution/zi-jie-ti-ku-zhong-deng-5mai-mai-gu-piao-de-zui-ji/
æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚